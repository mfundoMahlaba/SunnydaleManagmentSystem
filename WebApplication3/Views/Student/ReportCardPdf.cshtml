@model List<WebApplication3.ViewModels.StudentReportCardViewModel>
<style>
    body {
        background-color: #f8f9fa;
        font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    .text-center {
        text-align: center !important;
    }

    .text-muted {
        color: #6c757d !important;
    }

    .font-weight-bold {
        font-weight: 600 !important;
    }

    .border {
        border: 1px solid #dee2e6 !important;
        border-radius: 0.375rem;
        background-color: #ffffff;
    }

    .p-3 {
        padding: 1rem !important;
    }

    .mb-3 {
        margin-bottom: 1rem !important;
    }

    .mb-4 {
        margin-bottom: 1.5rem !important;
    }

    .mt-4 {
        margin-top: 1.5rem !important;
    }

    .mt-5 {
        margin-top: 3rem !important;
    }

    .table {
        font-size: 0.95rem;
        border-collapse: collapse;
    }

    .table-bordered {
        border: 1px solid #dee2e6;
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background-color: #f8f9fa;
    }

    .table th {
        background-color: #343a40;
        color: #fff;
        text-align: center;
        vertical-align: middle;
    }

    .table td {
        text-align: center;
        vertical-align: middle;
    }

    .alert-info {
        background-color: #e2f0fb;
        border-color: #bee5eb;
        color: #0c5460;
        font-size: 0.95rem;
        padding: 0.75rem 1rem;
        border-radius: 0.375rem;
    }

    .d-flex {
        display: flex !important;
    }

    .justify-content-center {
        justify-content: center !important;
    }

    table.signature-table td {
        padding: 1rem;
        vertical-align: top;
        font-size: 0.95rem;
    }

    table.signature-table p {
        margin: 0.25rem 0;
    }
</style>

<!-- Header with Logo -->
<div class="text-center mb-4">
    <img src="@Url.Content("~/Content/images/SunnyDaleSchoolLogo.png")" alt="School Logo" style="height: 100px;" />
    <p class="text-muted">@DateTime.Now.ToString("dddd, dd MMMM yyyy")</p>
</div>

@{
    var studentName = ViewBag.StudentName as string;
    var studentId = ViewBag.StudentId as int?;
    var academicYear = DateTime.Now.Year;
}

<!-- Report Title -->
<div class="text-center mb-3">
    <h5 class="font-weight-bold">Progress Report</h5>
</div>

<!-- Student Info -->
<div class="border p-3 mb-4">
    <p><strong>Student Number:</strong> @studentId</p>
    <p><strong>Name:</strong> @studentName</p>
    <p><strong>Academic Year:</strong> @academicYear</p>
</div>

<!-- Report Card Table -->
@if (Model.Any())
{
    var groupedByTerm = Model.GroupBy(m => m.Term);

    foreach (var termGroup in groupedByTerm)
    {
        <h5 class="mt-4"> @termGroup.Key</h5>
        <table class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>Subject</th>
                    <th>Grade</th>
                    <th>Test</th>
                    <th>Exam</th>
                    <th>Assignment</th>
                    <th>Average</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in termGroup)
                {
                    <tr>
                        <td>@item.SubjectName</td>
                        <td>@item.GradeName</td>
                        <td>@(item.TestMark.HasValue ? item.TestMark.Value.ToString("F1") : "—")</td>
                        <td>@(item.ExamMark.HasValue ? item.ExamMark.Value.ToString("F1") : "—")</td>
                        <td>@(item.AssignmentMark.HasValue ? item.AssignmentMark.Value.ToString("F1") : "—")</td>
                        <td>@item.Average.ToString("F1")</td>
                    </tr>
                }
            </tbody>
        </table>
    }
}
else
{
    <div class="alert alert-info">No marks captured yet.</div>
}

<div class="mt-5 d-flex justify-content-center">
    <table style="width: 80%;">
        <tr>
            <td style="width: 50%; text-align: left;">
                <p><strong>Prepared by:</strong></p>
                <p>__________________________</p>
                <p><em>Class Teacher</em></p>
                <p><strong>Date:</strong> @DateTime.Now.ToString("dd MMMM yyyy")</p>
            </td>
            <td style="width: 50%; text-align: right;">
                <p><strong>Approved by:</strong></p>
                <p>__________________________</p>
                <p><em>Principal</em></p>
                <p><strong>Date:</strong> @DateTime.Now.ToString("dd MMMM yyyy")</p>
            </td>
        </tr>
    </table>
</div>
